# Django_HTTP & Cookie

# HTTP(Hypter Text Transfer Protocol)

> HTML 문서와 같은 리소스들을 가져올 수 있도록 해주는 프로토콜(규칙, 규약)
> 
- 웹(WWW)에서 이루어지는 모든 데이터 교환의 기초

### 요청(requests)

> 클라이언트(브라우저)에 의해 전송되는 메시지
> 

### 응답(response)

> 서버에서 응답으로 전송되는 메시지
> 

## HTTP 특징

### 비 연결 지향(connectionless)

> 서버는 요청에 대한 응답을 보낸 후 연결을 끊음
> 

### 무상태(stateless)

> 연결을 끊는 순간 클라이언트와 서버 간의 통신이 끝나며 상태 정보가 유지되지 않음(서로 독립적)
> 

### 비 연결 지향, 무상태 라는 특징을 가졌음에도 로그인 상태를 유지할 수 있는 이유?

> **쿠키**와 **세션**이 존재하여 서버와 클라이언트 간의 상태 정보를 파악할 수 있음
> 

# 쿠키(Cookie)

> 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각
> 
- 사용자가 웹사이트를 방문할 경우 해당 웹사이트의 서버를 통해 사용자의 컴퓨터에 설치되는 작은 기록 정보 파일
    - 브라우저는 쿠키를 로컬에 KEY-VALUE의 데이터 형식으로 저장
    - 쿠키를 저장해 두었다가, **동일한 서버에 재요청 시 저장된 쿠키를 함께 전송**
- 쿠키는 요청이 동일한 브라우저에서 들어왔는지 아닌지 판단할 때 주로 사용
    - 이를 이용해 사용자의 로그인 상태를 유지할 수 있음
    - 무상태의 HTTP 프로토콜에서 상태 정보를 기억 시켜주기 때문
- 즉, 웹 페이지에 접속하면 웹 페이지를 응답한 서버로부터 쿠키를 받아 브라우저에 저장,
클라이언트가 같은 서버에 재요청 시마다 request와 함께 쿠키도 전송

## 쿠키 사용 목적

1. 세션 관리(Session management)
    - 로그인, 아이디 자동 완성, 공지 하루 안 보기, 팝업 체크, 장바구니 등
2. 개인화(Personalization)
    - 사용자 선호, 테마 등의 설정
3. 트래킹(Tracking)
    - 사용자 행동을 기록 및 분석

## 세션(Session)

> 사이트와 특정 브라우저 사이의 state(상태) 를 유지시키는 것
> 
- 클라이언트가 서버에 접속하면 서버가 특정 `session id`를 발급하고, 클라이언트는 `session id`를 쿠키에 저장
    - 클라이언트가 다시 동일한 서버에 접속하면 request와 함께 쿠키(`session id`가 저장된)를 서버에 전달
    - 쿠키는 요청 때마다 서버와 함께 전송되므로 서버에서 `session id`를 확인해 알맞은 로직을 처리
- `session id`는 세션을 구별하기 위해 필요, 쿠키에는 `session id`만 저장

## 쿠키 Lifetime(수명)

1. Session cookie
    - 현재 세션(current session)이 종료되면 삭제됨
    - 브라우저 종료와 함께 세션이 삭제됨
2. Persistent cookies
    - `Expires` 속성에 지정된 날짜 혹은 `Max-Age` 속성에 지정된 기간이 지나면 삭제

## django에서의 세션 관리

> Django는 **databse-backed sessions** 저장 방식을 기본 값으로 사용
> 
- session 정보는 Django DB의 `django_session` 테이블에 저장
- 설정을 통해 다른 저장 방식으로 변경 가능
- Django는 특정 `session id`를 포함하는 쿠키를 사용해서 각각의 브라우저와 사이트가 연결된 session을 알아냄
- Django는 우리가 sessions을 편리하게 사용하도록 도와줌